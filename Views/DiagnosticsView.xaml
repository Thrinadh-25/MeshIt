<UserControl x:Class="meshIt.Views.DiagnosticsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{DynamicResource PrimaryBackground}">
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="28,20" MaxWidth="600">

            <TextBlock Text="ðŸ“Š Network Diagnostics" FontSize="20" FontWeight="SemiBold"
                       Foreground="{DynamicResource PrimaryText}" Margin="0,0,0,20"/>

            <!-- Stats Grid -->
            <UniformGrid Columns="2" Margin="0,0,0,16">
                <!-- Active Peers -->
                <Border Background="{DynamicResource SecondaryBackground}" CornerRadius="12"
                        Padding="16" Margin="0,0,8,8">
                    <StackPanel>
                        <TextBlock Text="ðŸ“¡ Active Peers" FontSize="11"
                                   Foreground="{DynamicResource SecondaryText}"/>
                        <TextBlock Text="{Binding ActivePeers}" FontSize="32" FontWeight="Bold"
                                   Foreground="{DynamicResource AccentBrush}"/>
                    </StackPanel>
                </Border>

                <!-- Total Discovered -->
                <Border Background="{DynamicResource SecondaryBackground}" CornerRadius="12"
                        Padding="16" Margin="8,0,0,8">
                    <StackPanel>
                        <TextBlock Text="ðŸ” Total Discovered" FontSize="11"
                                   Foreground="{DynamicResource SecondaryText}"/>
                        <TextBlock Text="{Binding TotalPeersDiscovered}" FontSize="32" FontWeight="Bold"
                                   Foreground="{DynamicResource PrimaryText}"/>
                    </StackPanel>
                </Border>

                <!-- Messages Sent -->
                <Border Background="{DynamicResource SecondaryBackground}" CornerRadius="12"
                        Padding="16" Margin="0,0,8,8">
                    <StackPanel>
                        <TextBlock Text="ðŸ“¤ Messages Sent" FontSize="11"
                                   Foreground="{DynamicResource SecondaryText}"/>
                        <TextBlock Text="{Binding MessagesSent}" FontSize="32" FontWeight="Bold"
                                   Foreground="{DynamicResource SuccessBrush}"/>
                    </StackPanel>
                </Border>

                <!-- Messages Received -->
                <Border Background="{DynamicResource SecondaryBackground}" CornerRadius="12"
                        Padding="16" Margin="8,0,0,8">
                    <StackPanel>
                        <TextBlock Text="ðŸ“¥ Messages Received" FontSize="11"
                                   Foreground="{DynamicResource SecondaryText}"/>
                        <TextBlock Text="{Binding MessagesReceived}" FontSize="32" FontWeight="Bold"
                                   Foreground="{DynamicResource OnlineBrush}"/>
                    </StackPanel>
                </Border>
            </UniformGrid>

            <!-- Mesh Stats -->
            <Border Background="{DynamicResource SecondaryBackground}" CornerRadius="12"
                    Padding="20" Margin="0,0,0,16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                        <TextBlock Text="ðŸŒ" FontSize="20" HorizontalAlignment="Center"/>
                        <TextBlock Text="{Binding MeshHopsRelayed}" FontSize="18" FontWeight="Bold"
                                   Foreground="{DynamicResource PrimaryText}" HorizontalAlignment="Center"/>
                        <TextBlock Text="Hops Relayed" FontSize="10"
                                   Foreground="{DynamicResource MutedText}" HorizontalAlignment="Center"/>
                    </StackPanel>
                    <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                        <TextBlock Text="ðŸ“¦" FontSize="20" HorizontalAlignment="Center"/>
                        <TextBlock Text="{Binding PendingStoreForward}" FontSize="18" FontWeight="Bold"
                                   Foreground="{DynamicResource WarningBrush}" HorizontalAlignment="Center"/>
                        <TextBlock Text="Pending" FontSize="10"
                                   Foreground="{DynamicResource MutedText}" HorizontalAlignment="Center"/>
                    </StackPanel>
                    <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                        <TextBlock Text="ðŸ”" FontSize="20" HorizontalAlignment="Center"/>
                        <TextBlock Text="{Binding NoiseSessionsActive}" FontSize="18" FontWeight="Bold"
                                   Foreground="{DynamicResource AccentBrush}" HorizontalAlignment="Center"/>
                        <TextBlock Text="Sessions" FontSize="10"
                                   Foreground="{DynamicResource MutedText}" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Signal History -->
            <Border Background="{DynamicResource SecondaryBackground}" CornerRadius="12"
                    Padding="20" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Signal History" FontSize="14" FontWeight="SemiBold"
                               Foreground="{DynamicResource PrimaryText}" Margin="0,0,0,12"/>
                    <ItemsControl ItemsSource="{Binding SignalHistory}" MaxHeight="200">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="{Binding PeerName}" FontSize="11"
                                               Foreground="{DynamicResource SecondaryText}"/>
                                    <ProgressBar Grid.Column="1" Value="{Binding Rssi}" Minimum="-100" Maximum="0"
                                                 Height="6" Margin="8,0"
                                                 Foreground="{DynamicResource AccentBrush}"
                                                 Background="{DynamicResource SurfaceBackground}"/>
                                    <TextBlock Grid.Column="2" FontSize="11" Foreground="{DynamicResource MutedText}"
                                               HorizontalAlignment="Right">
                                        <Run Text="{Binding Rssi, Mode=OneWay}"/>
                                        <Run Text="dBm"/>
                                    </TextBlock>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
